<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🤖 PrivacyTreasuryAI - AI-Powered DAO Treasury Management</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        h1 {
            color: #1a202c;
            font-size: 32px;
            font-weight: 800;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .subtitle {
            color: #4a5568;
            font-size: 16px;
            margin-top: 5px;
        }
        
        .tech-badges {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .badge {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .status {
            padding: 10px 20px;
            border-radius: 10px;
            display: inline-block;
            font-weight: bold;
            font-size: 14px;
        }
        
        .status.online {
            background: #10b981;
            color: white;
            animation: pulse 2s infinite;
        }
        
        .status.offline {
            background: #ef4444;
            color: white;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.8; }
            100% { opacity: 1; }
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
            gap: 25px;
            margin-top: 25px;
        }
        
        .card {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 16px;
            padding: 28px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 50px rgba(0,0,0,0.15);
        }
        
        .card h2 {
            color: #1a202c;
            margin-bottom: 20px;
            font-size: 20px;
            font-weight: 700;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .portfolio-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 14px;
            background: #f7fafc;
            margin-bottom: 10px;
            border-radius: 10px;
            transition: all 0.2s;
            border: 2px solid transparent;
        }
        
        .portfolio-item:hover {
            transform: translateX(5px);
            background: #edf2f7;
            border-color: #667eea;
        }
        
        .asset-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .asset-symbol {
            font-weight: 700;
            color: #2d3748;
        }
        
        .asset-value {
            color: #4a5568;
            font-weight: 500;
        }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 10px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 15px;
            width: 100%;
            letter-spacing: 0.5px;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .analysis-result {
            background: linear-gradient(135deg, #ebf8ff, #f0f4ff);
            border-left: 4px solid #667eea;
            padding: 18px;
            margin-top: 20px;
            border-radius: 10px;
        }
        
        .recommendation {
            background: linear-gradient(135deg, #fffbeb, #fef3c7);
            border-left: 4px solid #f59e0b;
            padding: 14px;
            margin: 12px 0;
            border-radius: 8px;
            font-size: 14px;
        }
        
        .alert {
            background: linear-gradient(135deg, #fef2f2, #fee2e2);
            border-left: 4px solid #ef4444;
            padding: 14px;
            margin: 12px 0;
            border-radius: 8px;
            font-size: 14px;
        }
        
        .score-display {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            gap: 15px;
        }
        
        .score-item {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, #f7fafc, #edf2f7);
            border-radius: 12px;
            flex: 1;
            transition: transform 0.2s;
        }
        
        .score-item:hover {
            transform: scale(1.05);
        }
        
        .score-value {
            font-size: 36px;
            font-weight: 800;
            background: linear-gradient(135deg, #667eea, #764ba2);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .score-label {
            font-size: 12px;
            color: #718096;
            margin-top: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }
        
        input, select {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 15px;
            transition: border-color 0.2s;
            background: #f7fafc;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
            background: white;
        }
        
        .transaction-form {
            display: grid;
            gap: 12px;
        }
        
        .loading {
            text-align: center;
            color: #667eea;
            font-style: italic;
            padding: 30px;
            font-size: 16px;
        }
        
        .tx-result {
            background: linear-gradient(135deg, #e0e7ff, #c7d2fe);
            padding: 18px;
            border-radius: 12px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            word-break: break-all;
            font-size: 13px;
        }
        
        .add-asset-form {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .add-asset-form input {
            flex: 1;
        }
        
        .add-asset-form button {
            width: auto;
            margin: 0;
            padding: 12px 20px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #f7fafc, #edf2f7);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #2d3748;
        }
        
        .stat-label {
            font-size: 11px;
            color: #718096;
            text-transform: uppercase;
            margin-top: 5px;
            letter-spacing: 0.5px;
        }
        
        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 24px;
            }
            
            .header-content {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <div>
                    <h1>🤖 PrivacyTreasuryAI</h1>
                    <div class="subtitle">AI-Powered DAO Treasury Management with Zero-Knowledge Privacy</div>
                    <div class="tech-badges">
                        <span class="badge">Midnight Blockchain</span>
                        <span class="badge">ElizaOS Agents</span>
                        <span class="badge">DEGA MCP</span>
                        <span class="badge">Zero-Knowledge Proofs</span>
                    </div>
                </div>
                <div id="status" class="status offline">🔴 Disconnected</div>
            </div>
        </header>
        
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value" id="totalValue">$0</div>
                <div class="stat-label">Total Value</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="numAssets">0</div>
                <div class="stat-label">Assets</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="avgRisk">0</div>
                <div class="stat-label">Risk Score</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="privacyLevel">🔒</div>
                <div class="stat-label">Privacy</div>
            </div>
        </div>
        
        <div class="grid">
            <!-- Portfolio Card -->
            <div class="card">
                <h2>💼 DAO Treasury Portfolio</h2>
                <div id="portfolio">
                    <div class="portfolio-item">
                        <div class="asset-info">
                            <span class="asset-symbol">ETH</span>
                            <span class="asset-value">5.5 ETH</span>
                        </div>
                        <div>$8,800</div>
                    </div>
                    <div class="portfolio-item">
                        <div class="asset-info">
                            <span class="asset-symbol">USDC</span>
                            <span class="asset-value">12,000 USDC</span>
                        </div>
                        <div>$12,000</div>
                    </div>
                    <div class="portfolio-item">
                        <div class="asset-info">
                            <span class="asset-symbol">MATIC</span>
                            <span class="asset-value">5,000 MATIC</span>
                        </div>
                        <div>$3,500</div>
                    </div>
                </div>
                
                <div class="add-asset-form">
                    <input type="text" id="newAssetSymbol" placeholder="Symbol (e.g., BTC)">
                    <input type="number" id="newAssetAmount" placeholder="Amount">
                    <input type="number" id="newAssetValue" placeholder="Value USD">
                    <button onclick="addAsset()">Add</button>
                </div>
                
                <button onclick="analyzePortfolio()">🔍 Analyze with AI</button>
            </div>
            
            <!-- AI Analysis Card -->
            <div class="card">
                <h2>📊 AI Analysis Results</h2>
                <div id="analysisResult">
                    <div class="loading">Click "Analyze with AI" to get intelligent portfolio insights using our advanced AI agent powered by ElizaOS.</div>
                </div>
            </div>
            
            <!-- Private Transaction Card -->
            <div class="card">
                <h2>🔒 Private Transaction (Midnight)</h2>
                <div class="transaction-form">
                    <input type="text" id="txFrom" placeholder="From Address" value="0xDAO_Treasury_Address">
                    <input type="text" id="txTo" placeholder="To Address">
                    <input type="number" id="txAmount" placeholder="Amount">
                    <select id="txAssetType">
                        <option value="ETH">ETH</option>
                        <option value="USDC">USDC</option>
                        <option value="MATIC">MATIC</option>
                    </select>
                    <button onclick="createPrivateTransaction()">🔐 Create Shielded Transaction</button>
                </div>
                <div id="txResult"></div>
            </div>
            
            <!-- AI Recommendations Card -->
            <div class="card">
                <h2>🎯 AI Recommendations</h2>
                <div id="recommendations">
                    <div class="recommendation">
                        <strong>🛡️ Risk Management:</strong> Current portfolio shows moderate risk. Consider increasing stable coin allocation during volatile periods.
                    </div>
                    <div class="recommendation">
                        <strong>📈 Yield Optimization:</strong> ETH staking opportunities available. Potential 4-6% APY through liquid staking protocols.
                    </div>
                    <div class="recommendation">
                        <strong>⚖️ Rebalancing:</strong> Portfolio is well-diversified. Next rebalancing recommended in 2 weeks based on market conditions.
                    </div>
                </div>
                <button onclick="getRecommendations()">🤖 Get Fresh AI Recommendations</button>
            </div>
            
            <!-- Rebalancing Simulator Card -->
            <div class="card">
                <h2>⚖️ Portfolio Rebalancing Simulator</h2>
                <div id="rebalanceResult">
                    <p>Simulate portfolio rebalancing with AI-optimized allocations. Our system analyzes market conditions and suggests optimal asset distribution.</p>
                </div>
                <button onclick="simulateRebalance()">🎯 Simulate AI Rebalancing</button>
            </div>
            
            <!-- Agent Communication Card -->
            <div class="card">
                <h2>🤝 Agent Communication (DEGA MCP)</h2>
                <input type="text" id="agentMessage" placeholder="Message to send to other agents...">
                <input type="text" id="targetAgent" placeholder="Target Agent (e.g., RiskAnalyzer)" value="TreasuryOptimizer">
                <div id="agentResponse"></div>
                <button onclick="sendAgentMessage()">📡 Send Message via DEGA MCP</button>
            </div>

            <!-- ML Portfolio Optimization Card -->
            <div class="card">
                <h2>🧠 ML Portfolio Optimization</h2>
                <label>Risk Tolerance: <input type="range" id="riskTolerance" min="0" max="1" step="0.1" value="0.5"><span id="riskValue">0.5</span></label>
                <label>Time Horizon (months): <input type="number" id="timeHorizon" value="12" min="1" max="60"></label>
                <div id="mlOptimizationResult"></div>
                <button onclick="runMLOptimization()">🤖 Optimize with ML</button>
            </div>

            <!-- Advanced Risk Assessment Card -->
            <div class="card">
                <h2>📊 Advanced Risk Assessment</h2>
                <div id="riskAssessmentResult"></div>
                <button onclick="runRiskAssessment()">🔍 Analyze Risk Metrics</button>
            </div>

            <!-- Yield Optimization Card -->
            <div class="card">
                <h2>💰 DeFi Yield Optimization</h2>
                <select id="yieldStrategy">
                    <option value="conservative">Conservative (3-7% APY)</option>
                    <option value="moderate">Moderate (7-15% APY)</option>
                    <option value="aggressive">Aggressive (15%+ APY)</option>
                </select>
                <div id="yieldOptimizationResult"></div>
                <button onclick="runYieldOptimization()">🚀 Find Yield Opportunities</button>
            </div>

            <!-- Correlation Analysis Card -->
            <div class="card">
                <h2>🔗 Asset Correlation Matrix</h2>
                <div id="correlationResult"></div>
                <button onclick="runCorrelationAnalysis()">📈 Analyze Correlations</button>
            </div>

            <!-- Multi-Chain Portfolio Card -->
            <div class="card">
                <h2>🌉 Multi-Chain Portfolio</h2>
                <input type="text" id="walletAddress" placeholder="Enter wallet address (0x...)" value="0x742d35Cc6c4b6E5E9F2F4D8C4B5eF6A1b2c3d4e5">
                <div id="multiChainResult"></div>
                <button onclick="getMultiChainBalances()">🔍 Scan All Chains</button>
            </div>

            <!-- Cross-Chain Bridge Card -->
            <div class="card">
                <h2>🌉 Cross-Chain Bridge</h2>
                <select id="fromChain">
                    <option value="ethereum">Ethereum</option>
                    <option value="polygon">Polygon</option>
                    <option value="arbitrum">Arbitrum</option>
                    <option value="solana">Solana</option>
                </select>
                <select id="toChain">
                    <option value="polygon">Polygon</option>
                    <option value="ethereum">Ethereum</option>
                    <option value="arbitrum">Arbitrum</option>
                    <option value="solana">Solana</option>
                </select>
                <input type="text" id="bridgeAsset" placeholder="Asset (e.g., USDC)" value="USDC">
                <input type="number" id="bridgeAmount" placeholder="Amount" value="1000">
                <input type="text" id="recipientAddress" placeholder="Recipient address" value="0x742d35Cc6c4b6E5E9F2F4D8C4B5eF6A1b2c3d4e5">
                <div id="bridgeResult"></div>
                <button onclick="initiateBridge()">🚀 Bridge Assets</button>
            </div>

            <!-- Gas Optimization Card -->
            <div class="card">
                <h2>⛽ Gas Optimization</h2>
                <div id="gasOptimizationResult"></div>
                <button onclick="optimizeGas()">📊 Analyze Gas Fees</button>
            </div>

            <!-- Cross-Chain Rebalancing Card -->
            <div class="card">
                <h2>🔄 Cross-Chain Rebalancing</h2>
                <label>Target ETH %: <input type="number" id="ethPercent" value="40" min="0" max="100"></label>
                <label>Target USDC %: <input type="number" id="usdcPercent" value="30" min="0" max="100"></label>
                <label>Target SOL %: <input type="number" id="solPercent" value="20" min="0" max="100"></label>
                <label>Target MATIC %: <input type="number" id="maticPercent" value="10" min="0" max="100"></label>
                <div id="crossChainRebalanceResult"></div>
                <button onclick="runCrossChainRebalancing()">🌉 Optimize Across Chains</button>
            </div>

            <!-- Gaming Treasury Operation Card -->
            <div class="card">
                <h2>🎮 Gaming Treasury Operations</h2>
                <input type="text" id="gameId" placeholder="Game ID (e.g., dega-rpg-01)" value="dega-rpg-01">
                <input type="text" id="playerId" placeholder="Player ID (e.g., player123)" value="player123">
                <select id="gameOperation">
                    <option value="mint">Mint Tokens</option>
                    <option value="burn">Burn Tokens</option>
                    <option value="transfer">Transfer Assets</option>
                    <option value="stake">Stake Tokens</option>
                    <option value="reward">Distribute Rewards</option>
                </select>
                <input type="number" id="gameAmount" placeholder="Amount" value="100">
                <input type="text" id="tokenType" placeholder="Token Type (e.g., DEGA)" value="DEGA">
                <div id="gameOperationResult"></div>
                <button onclick="processGameOperation()">🚀 Execute Game Operation</button>
            </div>

            <!-- dAuth Wallet Management Card -->
            <div class="card">
                <h2>🔐 dAuth Wallet Management</h2>
                <input type="text" id="newPlayerId" placeholder="Player ID for new wallet" value="newplayer456">
                <input type="text" id="newGameId" placeholder="Game ID" value="dega-rpg-01">
                <div id="walletCreationResult"></div>
                <button onclick="createPlayerWallet()">👛 Create dAuth Wallet</button>
                <hr>
                <input type="text" id="authToken" placeholder="Authentication Token" value="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...">
                <div id="authResult"></div>
                <button onclick="authenticatePlayer()">🔒 Authenticate Player</button>
            </div>

            <!-- MCP Agent Communication Card -->
            <div class="card">
                <h2>📡 MCP Agent Communication</h2>
                <input type="text" id="mcpTargetAgent" placeholder="Target Agent" value="GameAnalyticsAgent">
                <select id="mcpMethod">
                    <option value="gaming.treasury.balance">Get Treasury Balance</option>
                    <option value="gaming.player.stats">Get Player Stats</option>
                    <option value="gaming.transaction.validate">Validate Transaction</option>
                </select>
                <input type="text" id="mcpParams" placeholder='Parameters (JSON)' value='{"playerId":"player123"}'>
                <div id="mcpResult"></div>
                <button onclick="communicateWithMCPAgent()">📡 Send MCP Message</button>
            </div>

            <!-- Gaming Analytics Card -->
            <div class="card">
                <h2>📊 Gaming Treasury Analytics</h2>
                <input type="text" id="analyticsGameId" placeholder="Game ID" value="dega-rpg-01">
                <div id="gamingAnalyticsResult"></div>
                <button onclick="getGamingAnalytics()">📈 Generate Analytics</button>
            </div>

            <!-- Metachin Optimization Card -->
            <div class="card">
                <h2>⚡ Metachin Scaling Optimization</h2>
                <div id="metachainResult"></div>
                <button onclick="optimizeMetachains()">🔧 Optimize Scaling</button>
            </div>

            <!-- DEGA Service Status Card -->
            <div class="card">
                <h2>🎮 DEGA Service Status</h2>
                <div id="degaStatusResult"></div>
                <button onclick="getDEGAStatus()">📊 Check Service Status</button>
            </div>
        </div>
    </div>
    
    <script>
        // API Configuration
        const API_URL = 'http://localhost:3001';
        
        // Current portfolio state
        let portfolio = [
            { symbol: 'ETH', amount: 5.5, valueUSD: 8800 },
            { symbol: 'USDC', amount: 12000, valueUSD: 12000 },
            { symbol: 'MATIC', amount: 5000, valueUSD: 3500 }
        ];
        
        // Check API status
        async function checkStatus() {
            try {
                const response = await fetch(`${API_URL}/`);
                const data = await response.json();
                document.getElementById('status').className = 'status online';
                document.getElementById('status').innerHTML = '🟢 Connected';
            } catch (error) {
                document.getElementById('status').className = 'status offline';
                document.getElementById('status').innerHTML = '🔴 Disconnected';
            }
        }
        
        // Update statistics
        function updateStats() {
            const totalValue = portfolio.reduce((sum, asset) => sum + asset.valueUSD, 0);
            document.getElementById('totalValue').textContent = `$${totalValue.toLocaleString()}`;
            document.getElementById('numAssets').textContent = portfolio.length;
        }
        
        // Add new asset
        function addAsset() {
            const symbol = document.getElementById('newAssetSymbol').value.toUpperCase();
            const amount = parseFloat(document.getElementById('newAssetAmount').value);
            const valueUSD = parseFloat(document.getElementById('newAssetValue').value);
            
            if (symbol && amount && valueUSD) {
                portfolio.push({ symbol, amount, valueUSD });
                updatePortfolioDisplay();
                updateStats();
                
                // Clear form
                document.getElementById('newAssetSymbol').value = '';
                document.getElementById('newAssetAmount').value = '';
                document.getElementById('newAssetValue').value = '';
            }
        }
        
        // Update portfolio display
        function updatePortfolioDisplay() {
            const portfolioDiv = document.getElementById('portfolio');
            portfolioDiv.innerHTML = portfolio.map(asset => `
                <div class="portfolio-item">
                    <div class="asset-info">
                        <span class="asset-symbol">${asset.symbol}</span>
                        <span class="asset-value">${asset.amount.toLocaleString()} ${asset.symbol}</span>
                    </div>
                    <div>$${asset.valueUSD.toLocaleString()}</div>
                </div>
            `).join('');
        }
        
        // Analyze portfolio with AI
        async function analyzePortfolio() {
            const resultDiv = document.getElementById('analysisResult');
            resultDiv.innerHTML = '<div class="loading">🔄 Analyzing portfolio with AI...</div>';
            
            try {
                const response = await fetch(`${API_URL}/api/analyze-portfolio`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ assets: portfolio })
                });
                
                const analysis = await response.json();
                
                resultDiv.innerHTML = `
                    <div class="score-display">
                        <div class="score-item">
                            <div class="score-value">${analysis.riskScore}</div>
                            <div class="score-label">Risk Score</div>
                        </div>
                        <div class="score-item">
                            <div class="score-value">${analysis.diversificationScore}</div>
                            <div class="score-label">Diversification</div>
                        </div>
                    </div>
                    
                    <h3>💡 AI Recommendations:</h3>
                    ${analysis.recommendations.map(rec => `<div class="recommendation">${rec}</div>`).join('')}
                    
                    ${analysis.alerts.length > 0 ? `
                        <h3>⚠️ Alerts:</h3>
                        ${analysis.alerts.map(alert => `<div class="alert">${alert}</div>`).join('')}
                    ` : ''}
                    
                    <p><small>Analysis completed at ${new Date(analysis.timestamp).toLocaleString()}</small></p>
                `;
            } catch (error) {
                resultDiv.innerHTML = '<div class="alert">Failed to analyze portfolio. Please check if the server is running.</div>';
            }
        }
        
        // Create private transaction
        async function createPrivateTransaction() {
            const resultDiv = document.getElementById('txResult');
            resultDiv.innerHTML = '<div class="loading">🔄 Creating private transaction with Midnight...</div>';
            
            const txData = {
                from: document.getElementById('txFrom').value,
                to: document.getElementById('txTo').value,
                amount: parseFloat(document.getElementById('txAmount').value),
                assetType: document.getElementById('txAssetType').value
            };
            
            try {
                const response = await fetch(`${API_URL}/api/private-transaction`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(txData)
                });
                
                const transaction = await response.json();
                
                resultDiv.innerHTML = `
                    <div class="tx-result">
                        <h4>🔐 Shielded Transaction Created</h4>
                        <p><strong>ID:</strong> ${transaction.transactionId}</p>
                        <p><strong>Status:</strong> ${transaction.status}</p>
                        <p><strong>Type:</strong> ${transaction.type}</p>
                        <p><strong>ZK Proof:</strong> ${transaction.zkProof}</p>
                        <p><strong>Network:</strong> ${transaction.publicData.network}</p>
                        <p><strong>Privacy:</strong> ${transaction.privateData.message}</p>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = '<div class="alert">Failed to create transaction. Please check the server connection.</div>';
            }
        }
        
        // Get AI recommendations
        async function getRecommendations() {
            const resultDiv = document.getElementById('recommendations');
            resultDiv.innerHTML = '<div class="loading">🔄 Generating AI recommendations...</div>';
            
            const marketData = {
                currentAllocation: portfolio,
                marketConditions: {
                    trend: 'neutral',
                    volatility: 'medium',
                    sentiment: 'cautious'
                }
            };
            
            try {
                const response = await fetch(`${API_URL}/api/ai-recommendations`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(marketData)
                });
                
                const recommendations = await response.json();
                
                resultDiv.innerHTML = `
                    <div class="analysis-result">
                        <h4>🤖 AI Analysis (Confidence: ${(recommendations.confidenceScore * 100).toFixed(0)}%)</h4>
                        <p><strong>Market Assessment:</strong> ${recommendations.riskAssessment}</p>
                        <p><strong>Model:</strong> ${recommendations.aiModel}</p>
                        
                        <h4>📋 Recommendations:</h4>
                        ${recommendations.recommendations.map(rec => `
                            <div class="recommendation">
                                <strong>${rec.action}:</strong> ${rec.reason}
                                <span style="float: right; color: ${rec.priority === 'HIGH' ? '#ef4444' : rec.priority === 'MEDIUM' ? '#f59e0b' : '#10b981'};">
                                    ${rec.priority}
                                </span>
                            </div>
                        `).join('')}
                        
                        <p><small>Next review: ${recommendations.nextReviewIn}</small></p>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = '<div class="alert">Failed to generate recommendations.</div>';
            }
        }
        
        // Simulate rebalancing
        async function simulateRebalance() {
            const resultDiv = document.getElementById('rebalanceResult');
            resultDiv.innerHTML = '<div class="loading">🔄 Simulating portfolio rebalancing...</div>';
            
            const targetAllocation = [
                { symbol: 'ETH', targetPercentage: 40 },
                { symbol: 'USDC', targetPercentage: 50 },
                { symbol: 'MATIC', targetPercentage: 10 }
            ];
            
            try {
                const response = await fetch(`${API_URL}/api/simulate-rebalance`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        currentPortfolio: portfolio,
                        targetAllocation: targetAllocation
                    })
                });
                
                const simulation = await response.json();
                
                resultDiv.innerHTML = `
                    <div class="analysis-result">
                        <h4>⚖️ Rebalancing Simulation</h4>
                        <p><strong>Current Value:</strong> $${simulation.currentTotalValue.toLocaleString()}</p>
                        
                        <h4>📊 Proposed Changes:</h4>
                        ${simulation.proposedChanges.map(change => `
                            <div class="recommendation">
                                <strong>${change.symbol}:</strong> ${change.action} $${change.amountUSD.toFixed(0)}
                                <br><small>Current: $${change.currentValue.toFixed(0)} → Target: $${change.targetValue.toFixed(0)}</small>
                            </div>
                        `).join('')}
                        
                        <h4>💰 Estimated Costs:</h4>
                        <p>Trading Fees: $${simulation.estimatedCosts.tradingFees.toFixed(2)}</p>
                        <p>Gas Fees: $${simulation.estimatedCosts.gasFees.toFixed(2)}</p>
                        <p><strong>Total Cost: $${simulation.estimatedCosts.total.toFixed(2)} (${simulation.estimatedCosts.percentage}%)</strong></p>
                        
                        <div class="recommendation">${simulation.recommendation}</div>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = '<div class="alert">Failed to simulate rebalancing.</div>';
            }
        }
        
        // Send agent message (DEGA MCP)
        async function sendAgentMessage() {
            const resultDiv = document.getElementById('agentResponse');
            resultDiv.innerHTML = '<div class="loading">🔄 Sending message to agent...</div>';
            
            const messageData = {
                message: document.getElementById('agentMessage').value,
                targetAgent: document.getElementById('targetAgent').value
            };
            
            try {
                const response = await fetch(`${API_URL}/api/agent-communication`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(messageData)
                });
                
                const agentResponse = await response.json();
                
                resultDiv.innerHTML = `
                    <div class="analysis-result">
                        <h4>📡 Agent Communication via DEGA MCP</h4>
                        <p><strong>Message ID:</strong> ${agentResponse.messageId}</p>
                        <p><strong>From:</strong> ${agentResponse.from}</p>
                        <p><strong>To:</strong> ${agentResponse.to}</p>
                        <p><strong>Status:</strong> ${agentResponse.status}</p>
                        <p><strong>Response:</strong> ${agentResponse.response}</p>
                        <p><small>Sent: ${new Date(agentResponse.timestamp).toLocaleString()}</small></p>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = '<div class="alert">Failed to send message to agent.</div>';
            }
        }
        
        // ML Portfolio Optimization
        async function runMLOptimization() {
            const resultDiv = document.getElementById('mlOptimizationResult');
            resultDiv.innerHTML = '<div class="loading">🧠 Running ML optimization...</div>';
            
            const optimizationData = {
                assets: portfolio,
                riskTolerance: parseFloat(document.getElementById('riskTolerance').value),
                timeHorizon: parseInt(document.getElementById('timeHorizon').value)
            };
            
            try {
                const response = await fetch(`${API_URL}/api/ml-optimization`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(optimizationData)
                });
                
                const optimization = await response.json();
                
                resultDiv.innerHTML = `
                    <div class="analysis-result">
                        <h4>🤖 ML Optimization Results</h4>
                        <p><strong>Analysis ID:</strong> ${optimization.optimization.analysisId}</p>
                        <p><strong>Expected Return:</strong> ${optimization.optimization.expectedReturn}%</p>
                        <p><strong>Risk Score:</strong> ${optimization.optimization.riskScore}/100</p>
                        <p><strong>Sharpe Ratio:</strong> ${optimization.optimization.sharpeRatio}</p>
                        <p><strong>Recommendation:</strong> ${optimization.optimization.recommendation}</p>
                        <p><small>Processed: ${new Date(optimization.timestamp).toLocaleString()}</small></p>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = '<div class="alert">Failed to run ML optimization.</div>';
            }
        }

        // Advanced Risk Assessment
        async function runRiskAssessment() {
            const resultDiv = document.getElementById('riskAssessmentResult');
            resultDiv.innerHTML = '<div class="loading">📊 Running advanced risk assessment...</div>';
            
            try {
                const response = await fetch(`${API_URL}/api/risk-assessment`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ assets: portfolio })
                });
                
                const assessment = await response.json();
                
                resultDiv.innerHTML = `
                    <div class="analysis-result">
                        <h4>🔍 Advanced Risk Metrics</h4>
                        <p><strong>Concentration Risk:</strong> ${(assessment.riskAssessment.concentrationRisk * 100).toFixed(1)}%</p>
                        <p><strong>Value at Risk (95%):</strong> $${assessment.riskAssessment.valueAtRisk.toLocaleString()}</p>
                        <p><strong>Expected Shortfall:</strong> $${assessment.riskAssessment.expectedShortfall.toLocaleString()}</p>
                        <p><strong>Portfolio Beta:</strong> ${assessment.riskAssessment.portfolioBeta}</p>
                        <p><small>Analyzed: ${new Date(assessment.timestamp).toLocaleString()}</small></p>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = '<div class="alert">Failed to run risk assessment.</div>';
            }
        }

        // Yield Optimization
        async function runYieldOptimization() {
            const resultDiv = document.getElementById('yieldOptimizationResult');
            resultDiv.innerHTML = '<div class="loading">💰 Finding yield opportunities...</div>';
            
            const strategy = document.getElementById('yieldStrategy').value;
            
            try {
                const response = await fetch(`${API_URL}/api/yield-optimization`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ assets: portfolio, strategy })
                });
                
                const yieldData = await response.json();
                
                resultDiv.innerHTML = `
                    <div class="analysis-result">
                        <h4>🚀 DeFi Yield Opportunities</h4>
                        <p><strong>Strategy:</strong> ${strategy.charAt(0).toUpperCase() + strategy.slice(1)}</p>
                        <p><strong>Total APY Potential:</strong> ${yieldData.yieldOpportunities.totalApy}%</p>
                        <p><strong>Best Protocol:</strong> ${yieldData.yieldOpportunities.bestProtocol}</p>
                        <p><strong>Risk Level:</strong> ${yieldData.yieldOpportunities.riskLevel}/10</p>
                        <div class="recommendation">${yieldData.yieldOpportunities.recommendation}</div>
                        <p><small>Updated: ${new Date(yieldData.timestamp).toLocaleString()}</small></p>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = '<div class="alert">Failed to optimize yield.</div>';
            }
        }

        // Correlation Analysis
        async function runCorrelationAnalysis() {
            const resultDiv = document.getElementById('correlationResult');
            resultDiv.innerHTML = '<div class="loading">🔗 Analyzing asset correlations...</div>';
            
            try {
                const response = await fetch(`${API_URL}/api/correlation-analysis`);
                const correlationData = await response.json();
                
                resultDiv.innerHTML = `
                    <div class="analysis-result">
                        <h4>📈 Asset Correlation Matrix</h4>
                        <p><strong>Diversification Ratio:</strong> ${(correlationData.correlationMatrix.diversificationRatio * 100).toFixed(1)}%</p>
                        <div class="recommendation">
                            ${correlationData.correlationMatrix.diversificationRatio > 0.7 ? 
                                "🟢 Well diversified portfolio" : 
                                "🟡 Consider adding uncorrelated assets"}
                        </div>
                        <p><small>Generated: ${new Date(correlationData.timestamp).toLocaleString()}</small></p>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = '<div class="alert">Failed to analyze correlations.</div>';
            }
        }

        // Multi-Chain Portfolio Balances
        async function getMultiChainBalances() {
            const resultDiv = document.getElementById('multiChainResult');
            resultDiv.innerHTML = '<div class="loading">🌉 Scanning multi-chain portfolio...</div>';
            
            const walletAddress = document.getElementById('walletAddress').value;
            
            try {
                const response = await fetch(`${API_URL}/api/multi-chain-balances`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ walletAddress })
                });
                
                const data = await response.json();
                
                resultDiv.innerHTML = `
                    <div class="analysis-result">
                        <h4>🌐 Multi-Chain Portfolio</h4>
                        <p><strong>Total Value:</strong> $${data.multiChainPortfolio.totalValueUSD.toLocaleString()}</p>
                        <p><strong>Chains Used:</strong> ${data.multiChainPortfolio.chainsUsed}</p>
                        <p><strong>Unique Assets:</strong> ${data.multiChainPortfolio.uniqueAssets}</p>
                        <p><strong>Diversification:</strong> ${data.multiChainPortfolio.diversificationRating}</p>
                        ${data.multiChainPortfolio.assets.slice(0, 3).map(asset => `
                            <div class="recommendation">
                                <strong>${asset.symbol}:</strong> ${asset.totalAmount.toFixed(2)} 
                                ($${asset.totalValueUSD.toLocaleString()}) across ${asset.chains.length} chains
                            </div>
                        `).join('')}
                        <p><small>Scanned: ${new Date(data.timestamp).toLocaleString()}</small></p>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = '<div class="alert">Failed to fetch multi-chain balances.</div>';
            }
        }

        // Cross-Chain Bridge
        async function initiateBridge() {
            const resultDiv = document.getElementById('bridgeResult');
            resultDiv.innerHTML = '<div class="loading">🌉 Initiating cross-chain bridge...</div>';
            
            const bridgeData = {
                fromChain: document.getElementById('fromChain').value,
                toChain: document.getElementById('toChain').value,
                asset: document.getElementById('bridgeAsset').value,
                amount: parseFloat(document.getElementById('bridgeAmount').value),
                recipientAddress: document.getElementById('recipientAddress').value
            };
            
            try {
                const response = await fetch(`${API_URL}/api/cross-chain-bridge`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(bridgeData)
                });
                
                const data = await response.json();
                
                resultDiv.innerHTML = `
                    <div class="analysis-result">
                        <h4>🚀 Bridge Operation Initiated</h4>
                        <p><strong>Operation ID:</strong> ${data.bridgeOperation.id}</p>
                        <p><strong>Route:</strong> ${data.bridgeOperation.fromChain} → ${data.bridgeOperation.toChain}</p>
                        <p><strong>Amount:</strong> ${data.bridgeOperation.amount} ${data.bridgeOperation.asset}</p>
                        <p><strong>Estimated Time:</strong> ${data.bridgeOperation.estimatedTime}</p>
                        <p><strong>Total Fees:</strong> $${data.bridgeOperation.fees.total.toFixed(2)}</p>
                        <p><strong>Status:</strong> ${data.bridgeOperation.status}</p>
                        <div class="recommendation">Bridge operation is being processed...</div>
                        <p><small>Initiated: ${new Date(data.timestamp).toLocaleString()}</small></p>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = '<div class="alert">Failed to initiate bridge operation.</div>';
            }
        }

        // Gas Optimization
        async function optimizeGas() {
            const resultDiv = document.getElementById('gasOptimizationResult');
            resultDiv.innerHTML = '<div class="loading">⛽ Analyzing gas optimization...</div>';
            
            try {
                const response = await fetch(`${API_URL}/api/gas-optimization`);
                const data = await response.json();
                
                resultDiv.innerHTML = `
                    <div class="analysis-result">
                        <h4>⛽ Gas Optimization Analysis</h4>
                        <p><strong>Ethereum:</strong> ${data.gasOptimization.optimization.ethereum.currentGwei} gwei → ${data.gasOptimization.optimization.ethereum.recommendedGwei} gwei (${data.gasOptimization.optimization.ethereum.savings} savings)</p>
                        <p><strong>Polygon:</strong> ${data.gasOptimization.optimization.polygon.currentGwei} gwei → ${data.gasOptimization.optimization.polygon.recommendedGwei} gwei (${data.gasOptimization.optimization.polygon.savings} savings)</p>
                        <p><strong>Best Time:</strong> ${data.gasOptimization.optimization.arbitrum.optimalTime}</p>
                        <div class="recommendation">${data.gasOptimization.recommendation}</div>
                        <p><strong>Potential Savings:</strong> ${data.gasOptimization.totalSavings}</p>
                        <p><small>Updated: ${new Date(data.timestamp).toLocaleString()}</small></p>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = '<div class="alert">Failed to optimize gas fees.</div>';
            }
        }

        // Cross-Chain Rebalancing
        async function runCrossChainRebalancing() {
            const resultDiv = document.getElementById('crossChainRebalanceResult');
            resultDiv.innerHTML = '<div class="loading">🔄 Calculating cross-chain rebalancing...</div>';
            
            const walletAddress = document.getElementById('walletAddress').value;
            const targetAllocation = {
                ETH: parseInt(document.getElementById('ethPercent').value),
                USDC: parseInt(document.getElementById('usdcPercent').value),
                SOL: parseInt(document.getElementById('solPercent').value),
                MATIC: parseInt(document.getElementById('maticPercent').value)
            };
            
            try {
                const response = await fetch(`${API_URL}/api/cross-chain-rebalancing`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ walletAddress, targetAllocation })
                });
                
                const data = await response.json();
                
                resultDiv.innerHTML = `
                    <div class="analysis-result">
                        <h4>🌉 Cross-Chain Rebalancing Strategy</h4>
                        <p><strong>Operations Required:</strong> ${data.rebalancing.operations.length}</p>
                        <p><strong>Estimated Total Fees:</strong> $${data.rebalancing.estimatedTotalFees.toFixed(2)}</p>
                        <p><strong>Estimated Time:</strong> ${data.rebalancing.estimatedTime}</p>
                        ${data.rebalancing.operations.slice(0, 3).map(op => `
                            <div class="recommendation">
                                <strong>${op.asset}:</strong> ${op.action} $${op.amount.toFixed(0)} on ${op.recommendedChain}
                                <br><small>Fees: $${op.estimatedFees.toFixed(2)}</small>
                            </div>
                        `).join('')}
                        <div class="recommendation">${data.rebalancing.recommendation}</div>
                        <p><small>Generated: ${new Date(data.timestamp).toLocaleString()}</small></p>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = '<div class="alert">Failed to calculate cross-chain rebalancing.</div>';
            }
        }

        // DEGA MCP Gaming Functions
        async function processGameOperation() {
            const resultDiv = document.getElementById('gameOperationResult');
            resultDiv.innerHTML = '<div class="loading">🔄 Processing game operation...</div>';
            
            const gameId = document.getElementById('gameId').value;
            const playerId = document.getElementById('playerId').value;
            const operation = document.getElementById('gameOperation').value;
            const amount = document.getElementById('gameAmount').value;
            const tokenType = document.getElementById('tokenType').value;
            
            try {
                const response = await fetch(`${API_URL}/api/dega/game-operation`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ gameId, playerId, operation, amount: parseFloat(amount), tokenType })
                });
                
                const result = await response.json();
                resultDiv.innerHTML = `
                    <div class="analysis-result">
                        <h4>🎮 Game Operation Complete!</h4>
                        <p><strong>Status:</strong> ${result.status}</p>
                        <p><strong>Transaction ID:</strong> ${result.transactionId || 'N/A'}</p>
                        <p><strong>Operation:</strong> ${operation} - ${amount} ${tokenType}</p>
                        <p><strong>Gas Used:</strong> ${result.gasUsed || 'N/A'}</p>
                        <p><small>Processed: ${new Date().toLocaleString()}</small></p>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = '<div class="alert">Failed to process game operation.</div>';
            }
        }

        async function createPlayerWallet() {
            const resultDiv = document.getElementById('walletCreationResult');
            resultDiv.innerHTML = '<div class="loading">🔄 Creating dAuth wallet...</div>';
            
            const playerId = document.getElementById('newPlayerId').value;
            const gameId = document.getElementById('newGameId').value;
            
            try {
                const response = await fetch(`${API_URL}/api/dega/create-wallet`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ playerId, gameId })
                });
                
                const result = await response.json();
                resultDiv.innerHTML = `
                    <div class="analysis-result">
                        <h4>👛 dAuth Wallet Created!</h4>
                        <p><strong>Status:</strong> ${result.status}</p>
                        <p><strong>Wallet Address:</strong> ${result.walletAddress}</p>
                        <p><strong>JWT Token:</strong> ${result.jwtToken ? '***' + result.jwtToken.slice(-10) : 'N/A'}</p>
                        <p><strong>Expiry:</strong> ${result.expiresIn || 'N/A'}</p>
                        <p><small>Created: ${new Date().toLocaleString()}</small></p>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = '<div class="alert">Failed to create wallet.</div>';
            }
        }

        async function authenticatePlayer() {
            const resultDiv = document.getElementById('authResult');
            resultDiv.innerHTML = '<div class="loading">🔄 Authenticating player...</div>';
            
            const token = document.getElementById('authToken').value;
            
            try {
                const response = await fetch(`${API_URL}/api/dega/authenticate`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ token })
                });
                
                const result = await response.json();
                resultDiv.innerHTML = `
                    <div class="analysis-result">
                        <h4>🔒 Authentication Result</h4>
                        <p><strong>Status:</strong> ${result.status}</p>
                        <p><strong>Valid:</strong> ${result.valid ? '✅ Yes' : '❌ No'}</p>
                        <p><strong>Player ID:</strong> ${result.playerId || 'N/A'}</p>
                        <p><strong>Game ID:</strong> ${result.gameId || 'N/A'}</p>
                        <p><small>Verified: ${new Date().toLocaleString()}</small></p>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = '<div class="alert">Authentication failed.</div>';
            }
        }

        async function communicateWithMCPAgent() {
            const resultDiv = document.getElementById('mcpResult');
            resultDiv.innerHTML = '<div class="loading">🔄 Communicating with MCP agent...</div>';
            
            const targetAgent = document.getElementById('mcpTargetAgent').value;
            const method = document.getElementById('mcpMethod').value;
            const params = document.getElementById('mcpParams').value;
            
            try {
                const response = await fetch(`${API_URL}/api/dega/mcp-communicate`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ targetAgent, method, params: JSON.parse(params) })
                });
                
                const result = await response.json();
                resultDiv.innerHTML = `
                    <div class="analysis-result">
                        <h4>📡 MCP Communication Result</h4>
                        <p><strong>Status:</strong> ${result.status}</p>
                        <p><strong>Agent:</strong> ${targetAgent}</p>
                        <p><strong>Method:</strong> ${method}</p>
                        <p><strong>Response Time:</strong> ${result.responseTime || 'N/A'}ms</p>
                        <p><strong>Message ID:</strong> ${result.messageId || 'N/A'}</p>
                        <p><small>Sent: ${new Date().toLocaleString()}</small></p>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = '<div class="alert">MCP communication failed.</div>';
            }
        }

        async function getGamingAnalytics() {
            const resultDiv = document.getElementById('gamingAnalyticsResult');
            resultDiv.innerHTML = '<div class="loading">🔄 Generating gaming analytics...</div>';
            
            const gameId = document.getElementById('analyticsGameId').value;
            
            try {
                const response = await fetch(`${API_URL}/api/dega/analytics`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ gameId })
                });
                
                const result = await response.json();
                resultDiv.innerHTML = `
                    <div class="analysis-result">
                        <h4>📊 Gaming Treasury Analytics</h4>
                        <p><strong>Total Players:</strong> ${result.totalPlayers || 'N/A'}</p>
                        <p><strong>Treasury Balance:</strong> ${result.treasuryBalance || 'N/A'} DEGA</p>
                        <p><strong>Daily Volume:</strong> $${result.dailyVolume || 'N/A'}</p>
                        <p><strong>Active Sessions:</strong> ${result.activeSessions || 'N/A'}</p>
                        <p><strong>Revenue (24h):</strong> $${result.dailyRevenue || 'N/A'}</p>
                        <p><small>Generated: ${new Date().toLocaleString()}</small></p>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = '<div class="alert">Failed to generate analytics.</div>';
            }
        }

        async function optimizeMetachains() {
            const resultDiv = document.getElementById('metachainResult');
            resultDiv.innerHTML = '<div class="loading">🔄 Optimizing metachin scaling...</div>';
            
            try {
                const response = await fetch(`${API_URL}/api/dega/metachin-optimize`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });
                
                const result = await response.json();
                resultDiv.innerHTML = `
                    <div class="analysis-result">
                        <h4>⚡ Metachin Optimization Complete</h4>
                        <p><strong>Status:</strong> ${result.status}</p>
                        <p><strong>Performance Improvement:</strong> ${result.performanceImprovement || 'N/A'}%</p>
                        <p><strong>Gas Savings:</strong> ${result.gasSavings || 'N/A'}%</p>
                        <p><strong>Optimized Chains:</strong> ${result.optimizedChains?.join(', ') || 'N/A'}</p>
                        <p><strong>Latency Reduction:</strong> ${result.latencyReduction || 'N/A'}ms</p>
                        <p><small>Optimized: ${new Date().toLocaleString()}</small></p>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = '<div class="alert">Metachin optimization failed.</div>';
            }
        }

        async function getDEGAStatus() {
            const resultDiv = document.getElementById('degaStatusResult');
            resultDiv.innerHTML = '<div class="loading">🔄 Checking DEGA service status...</div>';
            
            try {
                const response = await fetch(`${API_URL}/api/dega/status`, {
                    method: 'GET',
                    headers: { 'Content-Type': 'application/json' }
                });
                
                const result = await response.json();
                resultDiv.innerHTML = `
                    <div class="analysis-result">
                        <h4>🎮 DEGA Service Status</h4>
                        <p><strong>Service Status:</strong> ${result.status === 'active' ? '🟢 Active' : '🔴 Inactive'}</p>
                        <p><strong>Active Games:</strong> ${result.activeGames || 'N/A'}</p>
                        <p><strong>Total Players:</strong> ${result.totalPlayers || 'N/A'}</p>
                        <p><strong>MCP Agents:</strong> ${result.mcpAgents || 'N/A'}</p>
                        <p><strong>System Health:</strong> ${result.systemHealth || 'N/A'}%</p>
                        <p><strong>Uptime:</strong> ${result.uptime || 'N/A'}</p>
                        <p><small>Checked: ${new Date().toLocaleString()}</small></p>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = '<div class="alert">Failed to check service status.</div>';
            }
        }

        // Update risk tolerance display
        document.getElementById('riskTolerance').addEventListener('input', function() {
            document.getElementById('riskValue').textContent = this.value;
        });

        // Initialize
        checkStatus();
        updateStats();
        setInterval(checkStatus, 5000); // Check status every 5 seconds
    </script>
</body>
</html>